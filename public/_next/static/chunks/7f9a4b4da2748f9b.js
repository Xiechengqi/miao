(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,56296,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"warnOnce",{enumerable:!0,get:function(){return r}});let r=e=>{}},9165,e=>{"use strict";let t=new class{token=null;constructor(){this.token=localStorage.getItem("miao_token")}setToken(e){this.token=e,localStorage.setItem("miao_token",e)}clearToken(){this.token=null,localStorage.removeItem("miao_token")}async fetch(e,t={}){let a={"Content-Type":"application/json",...t.headers};this.token&&(a.Authorization=`Bearer ${this.token}`);let r=await fetch(`${e}`,{...t,headers:a});if(401===r.status)throw this.clearToken(),window.location.href="/login",Error("Unauthorized");if(!r.ok){let e=await r.json().catch(()=>({error:r.statusText}));throw Error(e?.error||`API Error: ${r.statusText}`)}return r.json()}async login(e){let t=await this.fetch("/api/login",{method:"POST",body:JSON.stringify({password:e})});return this.setToken(t.token),t}async setup(e){await this.fetch("/api/setup/init",{method:"POST",body:JSON.stringify({password:e})})}async checkSetupRequired(){return this.fetch("/api/setup/status")}async getStatus(){return(await this.fetch("/api/status")).data}async getSystemInfo(){return(await this.fetch("/api/system/info")).data}async getSystemStatus(){return(await this.fetch("/api/system/status")).data}async getSystemMetrics(e,t){let a=new URLSearchParams({range:e});return t&&a.set("step",t),(await this.fetch(`/api/system/metrics?${a.toString()}`)).data}async startService(){return(await this.fetch("/api/status/start",{method:"POST"})).data}async stopService(){return(await this.fetch("/api/status/stop",{method:"POST"})).data}async getDnsStatus(){return(await this.fetch("/api/dns")).data}async checkDns(){return(await this.fetch("/api/dns/check")).data}async switchDns(e){await this.fetch("/api/dns/switch",{method:"POST",body:JSON.stringify({name:e})})}async getSubFiles(){return(await this.fetch("/api/sub-files")).data}async reloadSubFiles(){await this.fetch("/api/sub-files/reload",{method:"POST"})}async getNodes(){return(await this.fetch("/api/nodes")).data}async getNode(e){return(await this.fetch(`/api/nodes/${encodeURIComponent(e)}`)).data}async createNode(e){await this.fetch("/api/nodes",{method:"POST",body:JSON.stringify(e)})}async updateNode(e,t){await this.fetch(`/api/nodes/${encodeURIComponent(e)}`,{method:"PUT",body:JSON.stringify(t)})}async deleteNode(e){await this.fetch("/api/nodes",{method:"DELETE",body:JSON.stringify({tag:e})})}async testNode(e,t,a=3e3){return(await this.fetch("/api/node-test",{method:"POST",body:JSON.stringify({server:e,server_port:t,timeout_ms:a})})).data}async testConnectivity(e){return(await this.fetch("/api/connectivity",{method:"POST",body:JSON.stringify({url:e})})).data}async getProxies(){return(await this.fetch("/api/clash/proxies")).data}async testDelay(e){return(await this.fetch("/api/clash/delays",{method:"POST",body:JSON.stringify({name:e})})).data}async switchProxy(e,t){await this.fetch("/api/clash/switch",{method:"POST",body:JSON.stringify({group:e,name:t})})}async getSyncs(){return(await this.fetch("/api/syncs")).data}async createSync(e){return(await this.fetch("/api/syncs",{method:"POST",body:JSON.stringify(e)})).data}async updateSync(e,t){await this.fetch(`/api/syncs/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteSync(e){await this.fetch(`/api/syncs/${e}`,{method:"DELETE"})}async startSync(e){await this.fetch(`/api/syncs/${e}/start`,{method:"POST"})}async stopSync(e){await this.fetch(`/api/syncs/${e}/stop`,{method:"POST"})}async testSync(e){await this.fetch(`/api/syncs/${e}/test`,{method:"POST"})}async getTcpTunnels(){return(await this.fetch("/api/tcp-tunnels")).data}async createTcpTunnel(e){return(await this.fetch("/api/tcp-tunnels",{method:"POST",body:JSON.stringify(e)})).data}async updateTcpTunnel(e,t){await this.fetch(`/api/tcp-tunnels/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteTcpTunnel(e){await this.fetch(`/api/tcp-tunnels/${e}`,{method:"DELETE"})}async restartTcpTunnel(e){await this.fetch(`/api/tcp-tunnels/${e}/restart`,{method:"POST"})}async startTcpTunnel(e){await this.fetch(`/api/tcp-tunnels/${e}/start`,{method:"POST"})}async stopTcpTunnel(e){await this.fetch(`/api/tcp-tunnels/${e}/stop`,{method:"POST"})}async testTcpTunnel(e){await this.fetch(`/api/tcp-tunnels/${e}/test`,{method:"POST"})}async copyTcpTunnel(e){await this.fetch(`/api/tcp-tunnels/${e}/copy`,{method:"POST"})}async getTerminals(){return(await this.fetch("/api/terminals")).data}async createTerminal(e){return(await this.fetch("/api/terminals",{method:"POST",body:JSON.stringify(e)})).data}async updateTerminal(e,t){await this.fetch(`/api/terminals/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteTerminal(e){await this.fetch(`/api/terminals/${e}`,{method:"DELETE"})}async startTerminal(e){await this.fetch(`/api/terminals/${e}/start`,{method:"POST"})}async stopTerminal(e){await this.fetch(`/api/terminals/${e}/stop`,{method:"POST"})}async restartTerminal(e){await this.fetch(`/api/terminals/${e}/restart`,{method:"POST"})}async upgradeGotty(){await this.fetch("/api/terminals/upgrade",{method:"POST"})}async getVncSessions(){return(await this.fetch("/api/vnc-sessions")).data}async createVncSession(e){return(await this.fetch("/api/vnc-sessions",{method:"POST",body:JSON.stringify(e)})).data}async updateVncSession(e,t){await this.fetch(`/api/vnc-sessions/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteVncSession(e){await this.fetch(`/api/vnc-sessions/${e}`,{method:"DELETE"})}async startVncSession(e){await this.fetch(`/api/vnc-sessions/${e}/start`,{method:"POST"})}async stopVncSession(e){await this.fetch(`/api/vnc-sessions/${e}/stop`,{method:"POST"})}async restartVncSession(e){await this.fetch(`/api/vnc-sessions/${e}/restart`,{method:"POST"})}async getApps(){return(await this.fetch("/api/apps")).data}async getAppTemplates(){return(await this.fetch("/api/apps/templates")).data}async createApp(e){return(await this.fetch("/api/apps",{method:"POST",body:JSON.stringify(e)})).data}async updateApp(e,t){await this.fetch(`/api/apps/${e}`,{method:"PUT",body:JSON.stringify(t)})}async startApp(e){await this.fetch(`/api/apps/${e}/start`,{method:"POST"})}async stopApp(e){await this.fetch(`/api/apps/${e}/stop`,{method:"POST"})}async restartApp(e){await this.fetch(`/api/apps/${e}/restart`,{method:"POST"})}async deleteApp(e){await this.fetch(`/api/apps/${e}`,{method:"DELETE"})}async checkUpdate(){return(await this.fetch("/api/update")).data}async performUpdate(){await this.fetch("/api/update",{method:"POST"})}async reloadSubscription(){await this.fetch("/api/clash/reload",{method:"POST"})}async getLogs(){return(await this.fetch("/api/logs")).data}};function a(){let e=localStorage.getItem("miao_token");if(!e)throw Error("No authentication token found. Please login first.");let t="".replace("http","ws");return`${t}/api/clash/ws/traffic?token=${e}`}function r(){let e=localStorage.getItem("miao_token");if(!e)throw Error("No authentication token found. Please login first.");let t="".replace("http","ws");return`${t}/api/clash/ws/logs?token=${e}`}e.s(["api",0,t,"getLogsWsUrl",()=>r,"getTrafficWsUrl",()=>a])},1257,e=>{"use strict";let t;var a=e.i(86646);let r=e=>{let t,a=new Set,r=(e,r)=>{let s="function"==typeof e?e(t):e;if(!Object.is(s,t)){let e=t;t=(null!=r?r:"object"!=typeof s||null===s)?s:Object.assign({},t,s),a.forEach(a=>a(t,e))}},s=()=>t,n={setState:r,getState:s,getInitialState:()=>i,subscribe:e=>(a.add(e),()=>a.delete(e))},i=t=e(r,s,n);return n},s=e=>{let t=e?r(e):r,s=e=>(function(e,t=e=>e){let r=a.default.useSyncExternalStore(e.subscribe,a.default.useCallback(()=>t(e.getState()),[e,t]),a.default.useCallback(()=>t(e.getInitialState()),[e,t]));return a.default.useDebugValue(r),r})(t,e);return Object.assign(s,t),s},n=(t=(e,t)=>({authenticated:!1,setupRequired:!1,status:{running:!1},dnsStatus:null,loading:!1,loadingAction:null,proxyGroups:{},nodes:[],delays:{},traffic:{up:0,down:0},syncs:[],syncsLoaded:!1,tcpTunnels:[],tcpTunnelsLoaded:!1,tcpTunnelsSupported:!0,terminals:[],terminalsLoaded:!1,logs:[],logWsConnected:!1,toasts:[],setAuthenticated:t=>e({authenticated:t}),setSetupRequired:t=>e({setupRequired:t}),setStatus:t=>e({status:t}),setDnsStatus:t=>e({dnsStatus:t}),setLoading:(t,a)=>e({loading:t,loadingAction:a||null}),setProxyGroups:t=>e({proxyGroups:t}),setNodes:t=>e({nodes:t}),setDelays:t=>e({delays:t}),setTraffic:t=>e({traffic:t}),setSyncs:t=>e({syncs:t}),setSyncsLoaded:t=>e({syncsLoaded:t}),setTcpTunnels:t=>e({tcpTunnels:t}),setTcpTunnelsLoaded:t=>e({tcpTunnelsLoaded:t}),setTcpTunnelsSupported:t=>e({tcpTunnelsSupported:t}),setTerminals:t=>e({terminals:t}),setTerminalsLoaded:t=>e({terminalsLoaded:t}),setLogs:t=>e({logs:t}),addLog:t=>e(e=>({logs:[t,...e.logs].slice(0,500)})),setLogWsConnected:t=>e({logWsConnected:t}),addToast:t=>e(e=>({toasts:[...e.toasts,{...t,id:Date.now().toString()}]})),removeToast:t=>e(e=>({toasts:e.toasts.filter(e=>e.id!==t)})),clearToasts:()=>e({toasts:[]}),getTcpDisplayItems:()=>{let{tcpTunnels:e}=t();return e}}))?s(t):s;e.s(["useStore",0,n],1257)},87208,(e,t,a)=>{t.exports=e.r(30204)},1836,e=>{"use strict";let t=(0,e.i(98631).default)("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);e.s(["Monitor",()=>t],1836)},64485,75354,20195,91310,47437,e=>{"use strict";var t=e.i(86646),a=e.i(1257),r=e.i(9165);function s(){let{status:e,dnsStatus:s,loading:n,loadingAction:i,setStatus:o,setDnsStatus:c,setLoading:l,addToast:u}=(0,a.useStore)(),d=(0,t.useCallback)(async()=>{try{let e=await r.api.getStatus();o(e)}catch(e){console.error("Failed to fetch status:",e)}},[o]),h=(0,t.useCallback)(async()=>{try{let e=await r.api.getDnsStatus();c(e)}catch(e){console.error("Failed to fetch DNS status:",e)}},[c]),p=(0,t.useCallback)(async()=>{l(!0,e.running?"stop":"start");try{let t=e.running?await r.api.stopService():await r.api.startService();o(t),u({type:"success",message:`服务${e.running?"已停止":"已启动"}`})}catch(e){u({type:"error",message:e instanceof Error?e.message:"操作失败"})}finally{l(!1)}},[e.running,o,l,u]),f=(0,t.useCallback)(async()=>{l(!0,"dns-check");try{let e=await r.api.checkDns();c(e),u({type:"success",message:"DNS 检测完成"})}catch(e){u({type:"error",message:e instanceof Error?e.message:"DNS 检测失败"})}finally{l(!1)}},[c,l,u]),y=(0,t.useCallback)(async e=>{l(!0,"dns-switch");try{await r.api.switchDns(e),await h(),u({type:"success",message:`已切换 DNS 到 ${e}`})}catch(e){u({type:"error",message:e instanceof Error?e.message:"DNS 切换失败"})}finally{l(!1)}},[l,u,h]);return{status:e,dnsStatus:s,loading:n,loadingAction:i,refreshStatus:d,refreshDnsStatus:h,toggleService:p,checkDnsNow:f,switchDnsActive:y}}function n(){let{proxyGroups:e,nodes:s,delays:n,setProxyGroups:i,setNodes:o,setDelays:c,addToast:l}=(0,a.useStore)(),u=(0,t.useCallback)(async()=>{try{let{proxies:e,nodes:t}=await r.api.getProxies();i(e),o(t)}catch(e){console.error("Failed to fetch proxies:",e),l({type:"error",message:"获取节点列表失败"})}},[i,o,l]),d=(0,t.useCallback)(async e=>{try{let t=await r.api.testDelay(e);return c({...n,[e]:t}),t}catch(e){console.error("Failed to test delay:",e);return}},[n,c]),h=(0,t.useCallback)(async()=>{let t=[];Object.values(e).forEach(e=>{e.all.forEach(e=>{t.includes(e)||t.push(e)})}),s.forEach(e=>{t.includes(e.name)||t.push(e.name)});let a={...n};for(let e of t)try{let t=await r.api.testDelay(e);a[e]=t}catch{a[e]=0}c(a),l({type:"success",message:"延迟测试完成"})},[e,s,n,c,l]),p=(0,t.useCallback)(async(e,t)=>{try{await r.api.switchProxy(e,t),await u(),l({type:"success",message:`已切换到 ${t}`})}catch(e){l({type:"error",message:e instanceof Error?e.message:"切换失败"})}},[u,l]),f=(0,t.useCallback)(async()=>{let t=[];if(Object.entries(e).forEach(([,e])=>{e.now&&e.all.forEach(e=>{let a=n[e];void 0!==a&&a>0&&t.push({name:e,delay:a})})}),0===t.length)return;let a=t.reduce((e,t)=>t.delay<e.delay?t:e);for(let[t,r]of Object.entries(e))if(r.all.includes(a.name)){await p(t,a.name);break}},[e,n,p]);return{proxyGroups:e,nodes:s,delays:n,fetchProxies:u,testDelay:d,testAllDelays:h,switchProxy:p,selectFastest:f}}function i(){let{traffic:e,setTraffic:s}=(0,a.useStore)(),n=(0,t.useRef)(null),i=(0,t.useRef)(null),c=(0,t.useRef)(0),l=(0,t.useCallback)(()=>{if(n.current?.readyState!==WebSocket.OPEN)try{let e=(0,r.getTrafficWsUrl)(),t=new WebSocket(e);t.onopen=()=>{c.current=0},t.onmessage=e=>{try{let t=JSON.parse(e.data);if(s(t),"u">typeof document){let e=o(t.up),a=o(t.down);document.title=`↑${e} ↓${a}`}}catch(e){console.error("Failed to parse traffic data:",e)}},t.onclose=()=>{let e=Math.min(1e3*Math.pow(2,c.current),3e4);i.current=setTimeout(()=>{c.current++,l()},e)},t.onerror=e=>{console.error("Traffic WebSocket error:",e)},n.current=t}catch(e){console.warn("Cannot connect to traffic WebSocket:",e)}},[s]),u=(0,t.useCallback)(()=>{i.current&&clearTimeout(i.current),n.current&&(n.current.close(),n.current=null)},[]);return(0,t.useEffect)(()=>(l(),()=>u()),[l,u]),{traffic:e,connect:l,disconnect:u}}function o(e){if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,t)).toFixed(1)} ${["B","KB","MB","GB"][t]}`}function c(){let{logs:e,logWsConnected:s,setLogs:n,addLog:i,setLogWsConnected:o}=(0,a.useStore)(),c=(0,t.useRef)(null),l=(0,t.useRef)(null),u=(0,t.useRef)(0),d=(0,t.useCallback)(()=>{if(c.current?.readyState!==WebSocket.OPEN)try{let e=(0,r.getLogsWsUrl)(),t=new WebSocket(e);t.onopen=()=>{u.current=0,o(!0)},t.onmessage=e=>{try{let t=JSON.parse(e.data);i(t)}catch(e){console.error("Failed to parse log entry:",e)}},t.onclose=()=>{o(!1);let e=Math.min(1e3*Math.pow(2,u.current),3e4);l.current=setTimeout(()=>{u.current++,d()},e)},t.onerror=e=>{console.error("Logs WebSocket error:",e)},c.current=t}catch(e){console.warn("Cannot connect to logs WebSocket:",e),o(!1)}},[i,o]),h=(0,t.useCallback)(()=>{l.current&&clearTimeout(l.current),c.current&&(c.current.close(),c.current=null),o(!1)},[o]),p=(0,t.useCallback)(()=>{n([])},[n]);return(0,t.useEffect)(()=>(d(),()=>h()),[d,h]),{logs:e,logWsConnected:s,connect:d,disconnect:h,clearLogs:p}}e.s(["useStatus",()=>s],75354),e.s(["useProxies",()=>n],20195),e.s(["useTraffic",()=>i],91310),e.s(["useLogs",()=>c],47437),e.s([],64485)},5482,e=>{"use strict";let t=(0,e.i(98631).default)("app-window",[["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}],["path",{d:"M10 4v4",key:"pp8u80"}],["path",{d:"M2 8h20",key:"d11cs7"}],["path",{d:"M6 4v4",key:"1svtjw"}]]);e.s(["AppWindow",()=>t],5482)},71798,e=>{"use strict";let t=(0,e.i(98631).default)("terminal",[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]]);e.s(["Terminal",()=>t],71798)},69210,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={assign:function(){return c},searchParamsToUrlQuery:function(){return n},urlQueryToSearchParams:function(){return o}};for(var s in r)Object.defineProperty(a,s,{enumerable:!0,get:r[s]});function n(e){let t={};for(let[a,r]of e.entries()){let e=t[a];void 0===e?t[a]=r:Array.isArray(e)?e.push(r):t[a]=[e,r]}return t}function i(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function o(e){let t=new URLSearchParams;for(let[a,r]of Object.entries(e))if(Array.isArray(r))for(let e of r)t.append(a,i(e));else t.set(a,i(r));return t}function c(e,...t){for(let a of t){for(let t of a.keys())e.delete(t);for(let[t,r]of a.entries())e.append(t,r)}return e}},24247,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={formatUrl:function(){return o},formatWithValidation:function(){return l},urlObjectKeys:function(){return c}};for(var s in r)Object.defineProperty(a,s,{enumerable:!0,get:r[s]});let n=e.r(44066)._(e.r(69210)),i=/https?|ftp|gopher|file/;function o(e){let{auth:t,hostname:a}=e,r=e.protocol||"",s=e.pathname||"",o=e.hash||"",c=e.query||"",l=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?l=t+e.host:a&&(l=t+(~a.indexOf(":")?`[${a}]`:a),e.port&&(l+=":"+e.port)),c&&"object"==typeof c&&(c=String(n.urlQueryToSearchParams(c)));let u=e.search||c&&`?${c}`||"";return r&&!r.endsWith(":")&&(r+=":"),e.slashes||(!r||i.test(r))&&!1!==l?(l="//"+(l||""),s&&"/"!==s[0]&&(s="/"+s)):l||(l=""),o&&"#"!==o[0]&&(o="#"+o),u&&"?"!==u[0]&&(u="?"+u),s=s.replace(/[?#]/g,encodeURIComponent),u=u.replace("#","%23"),`${r}${l}${s}${u}${o}`}let c=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function l(e){return o(e)}},12917,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"useMergedRef",{enumerable:!0,get:function(){return s}});let r=e.r(86646);function s(e,t){let a=(0,r.useRef)(null),s=(0,r.useRef)(null);return(0,r.useCallback)(r=>{if(null===r){let e=a.current;e&&(a.current=null,e());let t=s.current;t&&(s.current=null,t())}else e&&(a.current=n(e,r)),t&&(s.current=n(t,r))},[e,t])}function n(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let a=e(t);return"function"==typeof a?a:()=>e(null)}}("function"==typeof a.default||"object"==typeof a.default&&null!==a.default)&&void 0===a.default.__esModule&&(Object.defineProperty(a.default,"__esModule",{value:!0}),Object.assign(a.default,a),t.exports=a.default)},74522,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={DecodeError:function(){return g},MiddlewareNotFoundError:function(){return T},MissingStaticPage:function(){return S},NormalizeError:function(){return b},PageNotFoundError:function(){return w},SP:function(){return y},ST:function(){return m},WEB_VITALS:function(){return n},execOnce:function(){return i},getDisplayName:function(){return d},getLocationOrigin:function(){return l},getURL:function(){return u},isAbsoluteUrl:function(){return c},isResSent:function(){return h},loadGetInitialProps:function(){return f},normalizeRepeatedSlashes:function(){return p},stringifyError:function(){return x}};for(var s in r)Object.defineProperty(a,s,{enumerable:!0,get:r[s]});let n=["CLS","FCP","FID","INP","LCP","TTFB"];function i(e){let t,a=!1;return(...r)=>(a||(a=!0,t=e(...r)),t)}let o=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,c=e=>o.test(e);function l(){let{protocol:e,hostname:t,port:a}=window.location;return`${e}//${t}${a?":"+a:""}`}function u(){let{href:e}=window.location,t=l();return e.substring(t.length)}function d(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function h(e){return e.finished||e.headersSent}function p(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?`?${t.slice(1).join("?")}`:"")}async function f(e,t){let a=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await f(t.Component,t.ctx)}:{};let r=await e.getInitialProps(t);if(a&&h(a))return r;if(!r)throw Object.defineProperty(Error(`"${d(e)}.getInitialProps()" should resolve to an object. But found "${r}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return r}let y="u">typeof performance,m=y&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class g extends Error{}class b extends Error{}class w extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class S extends Error{constructor(e,t){super(),this.message=`Failed to load static file for page: ${e} ${t}`}}class T extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function x(e){return JSON.stringify({message:e.message,stack:e.stack})}},1781,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"isLocalURL",{enumerable:!0,get:function(){return n}});let r=e.r(74522),s=e.r(1186);function n(e){if(!(0,r.isAbsoluteUrl)(e))return!0;try{let t=(0,r.getLocationOrigin)(),a=new URL(e,t);return a.origin===t&&(0,s.hasBasePath)(a.pathname)}catch(e){return!1}}},95645,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"errorOnce",{enumerable:!0,get:function(){return r}});let r=e=>{}},21370,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={default:function(){return g},useLinkStatus:function(){return w}};for(var s in r)Object.defineProperty(a,s,{enumerable:!0,get:r[s]});let n=e.r(44066),i=e.r(87519),o=n._(e.r(86646)),c=e.r(24247),l=e.r(14791),u=e.r(12917),d=e.r(74522),h=e.r(52931);e.r(56296);let p=e.r(20092),f=e.r(1781),y=e.r(96422);function m(e){return"string"==typeof e?e:(0,c.formatUrl)(e)}function g(t){var a;let r,s,n,[c,g]=(0,o.useOptimistic)(p.IDLE_LINK_STATUS),w=(0,o.useRef)(null),{href:S,as:T,children:x,prefetch:k=null,passHref:O,replace:v,shallow:P,scroll:N,onClick:j,onMouseEnter:E,onTouchStart:_,legacyBehavior:C=!1,onNavigate:$,ref:M,unstable_dynamicOnHover:L,...A}=t;r=x,C&&("string"==typeof r||"number"==typeof r)&&(r=(0,i.jsx)("a",{children:r}));let R=o.default.useContext(l.AppRouterContext),D=!1!==k,U=!1!==k?null===(a=k)||"auto"===a?y.FetchStrategy.PPR:y.FetchStrategy.Full:y.FetchStrategy.PPR,{href:I,as:J}=o.default.useMemo(()=>{let e=m(S);return{href:e,as:T?m(T):e}},[S,T]);if(C){if(r?.$$typeof===Symbol.for("react.lazy"))throw Object.defineProperty(Error("`<Link legacyBehavior>` received a direct child that is either a Server Component, or JSX that was loaded with React.lazy(). This is not supported. Either remove legacyBehavior, or make the direct child a Client Component that renders the Link's `<a>` tag."),"__NEXT_ERROR_CODE",{value:"E863",enumerable:!1,configurable:!0});s=o.default.Children.only(r)}let F=C?s&&"object"==typeof s&&s.ref:M,W=o.default.useCallback(e=>(null!==R&&(w.current=(0,p.mountLinkInstance)(e,I,R,U,D,g)),()=>{w.current&&((0,p.unmountLinkForCurrentNavigation)(w.current),w.current=null),(0,p.unmountPrefetchableInstance)(e)}),[D,I,R,U,g]),B={ref:(0,u.useMergedRef)(W,F),onClick(t){C||"function"!=typeof j||j(t),C&&s.props&&"function"==typeof s.props.onClick&&s.props.onClick(t),!R||t.defaultPrevented||function(t,a,r,s,n,i,c){if("u">typeof window){let l,{nodeName:u}=t.currentTarget;if("A"===u.toUpperCase()&&((l=t.currentTarget.getAttribute("target"))&&"_self"!==l||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which)||t.currentTarget.hasAttribute("download"))return;if(!(0,f.isLocalURL)(a)){n&&(t.preventDefault(),location.replace(a));return}if(t.preventDefault(),c){let e=!1;if(c({preventDefault:()=>{e=!0}}),e)return}let{dispatchNavigateAction:d}=e.r(44883);o.default.startTransition(()=>{d(r||a,n?"replace":"push",i??!0,s.current)})}}(t,I,J,w,v,N,$)},onMouseEnter(e){C||"function"!=typeof E||E(e),C&&s.props&&"function"==typeof s.props.onMouseEnter&&s.props.onMouseEnter(e),R&&D&&(0,p.onNavigationIntent)(e.currentTarget,!0===L)},onTouchStart:function(e){C||"function"!=typeof _||_(e),C&&s.props&&"function"==typeof s.props.onTouchStart&&s.props.onTouchStart(e),R&&D&&(0,p.onNavigationIntent)(e.currentTarget,!0===L)}};return(0,d.isAbsoluteUrl)(J)?B.href=J:C&&!O&&("a"!==s.type||"href"in s.props)||(B.href=(0,h.addBasePath)(J)),n=C?o.default.cloneElement(s,B):(0,i.jsx)("a",{...A,...B,children:r}),(0,i.jsx)(b.Provider,{value:c,children:n})}e.r(95645);let b=(0,o.createContext)(p.IDLE_LINK_STATUS),w=()=>(0,o.useContext)(b);("function"==typeof a.default||"object"==typeof a.default&&null!==a.default)&&void 0===a.default.__esModule&&(Object.defineProperty(a.default,"__esModule",{value:!0}),Object.assign(a.default,a),t.exports=a.default)},39126,e=>{"use strict";var t=e.i(87519),a=e.i(86646),r=e.i(87208),s=e.i(21370);e.i(16787);var n=e.i(82291),i=e.i(85220),o=e.i(1257);e.i(64485);var c=e.i(91310),l=e.i(9165),u=e.i(98631);let d=(0,u.default)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);var h=e.i(71798),p=e.i(1836),f=e.i(5482);let y=(0,u.default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),m=(0,u.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),g=(0,u.default)("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]);var b=e.i(28781);let w=(0,u.default)("box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),S=(0,u.default)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);var T=e.i(75157);let x=[{href:"/dashboard/proxies",label:"代理",icon:d},{href:"/dashboard/sync",label:"备份",icon:S},{href:"/dashboard/tunnels",label:"穿透",icon:w},{href:"/dashboard/terminals",label:"终端",icon:h.Terminal},{href:"/dashboard/vnc",label:"桌面",icon:p.Monitor},{href:"/dashboard/apps",label:"应用",icon:f.AppWindow},{href:"/dashboard/logs",label:"日志",icon:y}];function k({children:e}){let u=(0,r.useRouter)(),d=(0,r.usePathname)(),{setAuthenticated:h,setSetupRequired:p,toasts:f,removeToast:y}=(0,o.useStore)(),[S,k]=(0,a.useState)(!1),[O,v]=(0,a.useState)(!1);return((0,c.useTraffic)(),(0,a.useEffect)(()=>{v(!0),(async()=>{let e=localStorage.getItem("miao_token");if(!e)return u.push("/login");try{l.api.setToken(e);let{required:t}=await l.api.checkSetupRequired();t&&u.push("/setup")}catch{localStorage.removeItem("miao_token"),u.push("/login")}})()},[u,h,p]),O)?(0,t.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[(0,t.jsx)(n.ClayBlobs,{}),(0,t.jsx)(i.ToastContainer,{toasts:f,onClose:y}),S&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-40 lg:hidden",onClick:()=>k(!1)}),(0,t.jsx)("aside",{className:(0,T.cn)("fixed top-0 left-0 h-full w-64 bg-white/70 backdrop-blur-xl shadow-[0_4px_20px_-2px_rgba(79,70,229,0.1)] z-50","transform transition-transform duration-300 ease-out","lg:translate-x-0",S?"translate-x-0":"-translate-x-full"),children:(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200/10",children:[(0,t.jsxs)(s.default,{href:"/dashboard",className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-[#A78BFA] to-[#7C3AED] flex items-center justify-center shadow-[0_4px_14px_0_rgba(79,70,229,0.3)]",children:(0,t.jsx)(w,{className:"w-5 h-5 text-white"})}),(0,t.jsx)("span",{className:"text-xl font-black",children:"Miao"})]}),(0,t.jsx)("button",{onClick:()=>k(!1),className:"lg:hidden p-2 rounded-full hover:bg-slate-500/10",children:(0,t.jsx)(b.X,{className:"w-5 h-5"})})]}),(0,t.jsx)("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:x.map(e=>{let a=d===e.href||"/dashboard"!==e.href&&d.startsWith(e.href);return(0,t.jsxs)(s.default,{href:e.href,className:(0,T.cn)("flex items-center gap-3 px-4 py-3 rounded-lg","transition-all duration-200",a?"bg-gradient-to-br from-[#A78BFA]/20 to-[#7C3AED]/10 text-indigo-600 font-semibold shadow-sm":"text-slate-500 hover:bg-indigo-600/5 hover:text-slate-900"),children:[(0,t.jsx)(e.icon,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:e.label})]},e.href)})}),(0,t.jsx)("div",{className:"p-4 border-t border-slate-200/10 space-y-1",children:(0,t.jsxs)("button",{onClick:()=>{localStorage.removeItem("miao_token"),l.api.clearToken(),h(!1),u.push("/login")},className:"flex items-center gap-3 w-full px-4 py-3 rounded-lg text-red-600 hover:bg-red-50/50 transition-colors",children:[(0,t.jsx)(m,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:"退出登录"})]})})]})}),(0,t.jsxs)("div",{className:"lg:pl-64",children:[(0,t.jsx)("header",{className:"lg:hidden sticky top-0 z-30 bg-slate-50/80 backdrop-blur-xl p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("button",{onClick:()=>k(!0),className:"p-2 rounded-lg bg-white/60 shadow-[0_4px_20px_-2px_rgba(79,70,229,0.1)] hover:shadow-[0_4px_14px_0_rgba(79,70,229,0.3)] transition-shadow",children:(0,t.jsx)(g,{className:"w-5 h-5"})}),(0,t.jsx)("span",{className:"text-lg font-black",children:"Miao"}),(0,t.jsx)("div",{className:"w-10"})]})}),(0,t.jsx)("main",{className:"p-4 lg:p-8 max-w-7xl mx-auto",children:e})]})]}):(0,t.jsxs)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:[(0,t.jsx)(n.ClayBlobs,{}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-12 h-12 border-4 border-indigo-600/30 border-t-indigo-600 rounded-full animate-spin mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-slate-500",children:"加载中..."})]})]})}e.s(["default",()=>k],39126)}]);