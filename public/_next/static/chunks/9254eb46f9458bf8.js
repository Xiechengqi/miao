(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,9165,t=>{"use strict";let e=new class{token=null;constructor(){this.token=localStorage.getItem("miao_token")}setToken(t){this.token=t,localStorage.setItem("miao_token",t)}clearToken(){this.token=null,localStorage.removeItem("miao_token")}async fetch(t,e={}){let a={"Content-Type":"application/json",...e.headers};this.token&&(a.Authorization=`Bearer ${this.token}`);let s=await fetch(`${t}`,{...e,headers:a});if(401===s.status)throw this.clearToken(),window.location.href="/login",Error("Unauthorized");if(!s.ok){let t=await s.json().catch(()=>({error:s.statusText}));throw Error(t?.error||`API Error: ${s.statusText}`)}return s.json()}async login(t){let e=await this.fetch("/api/login",{method:"POST",body:JSON.stringify({password:t})});return this.setToken(e.data.token),e.data}async setup(t){await this.fetch("/api/setup/init",{method:"POST",body:JSON.stringify({password:t})})}async checkSetupRequired(){return this.fetch("/api/setup/status")}async getStatus(){return(await this.fetch("/api/status")).data}async getSystemInfo(){return(await this.fetch("/api/system/info")).data}async getSystemStatus(){return(await this.fetch("/api/system/status")).data}async getSystemMetrics(t,e){let a=new URLSearchParams({range:t});return e&&a.set("step",e),(await this.fetch(`/api/system/metrics?${a.toString()}`)).data}async startService(){return(await this.fetch("/api/status/start",{method:"POST"})).data}async stopService(){return(await this.fetch("/api/status/stop",{method:"POST"})).data}async getDnsStatus(){return(await this.fetch("/api/dns")).data}async checkDns(){return(await this.fetch("/api/dns/check")).data}async switchDns(t){await this.fetch("/api/dns/switch",{method:"POST",body:JSON.stringify({name:t})})}async getSubFiles(){return(await this.fetch("/api/sub-files")).data}async reloadSubFiles(){await this.fetch("/api/sub-files/reload",{method:"POST"})}async getNodes(){return(await this.fetch("/api/nodes")).data}async getNode(t){return(await this.fetch(`/api/nodes/${encodeURIComponent(t)}`)).data}async createNode(t){await this.fetch("/api/nodes",{method:"POST",body:JSON.stringify(t)})}async updateNode(t,e){await this.fetch(`/api/nodes/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async deleteNode(t){await this.fetch("/api/nodes",{method:"DELETE",body:JSON.stringify({tag:t})})}async testNode(t,e,a=3e3){return(await this.fetch("/api/node-test",{method:"POST",body:JSON.stringify({server:t,server_port:e,timeout_ms:a})})).data}async testConnectivity(t){return(await this.fetch("/api/connectivity",{method:"POST",body:JSON.stringify({url:t})})).data}async getProxies(){return(await this.fetch("/api/clash/proxies")).data}async testDelay(t){return(await this.fetch("/api/clash/delays",{method:"POST",body:JSON.stringify({name:t})})).data}async switchProxy(t,e){await this.fetch("/api/clash/switch",{method:"POST",body:JSON.stringify({group:t,name:e})})}async getSyncs(){return(await this.fetch("/api/syncs")).data}async createSync(t){return(await this.fetch("/api/syncs",{method:"POST",body:JSON.stringify(t)})).data}async updateSync(t,e){await this.fetch(`/api/syncs/${t}`,{method:"PUT",body:JSON.stringify(e)})}async deleteSync(t){await this.fetch(`/api/syncs/${t}`,{method:"DELETE"})}async startSync(t){await this.fetch(`/api/syncs/${t}/start`,{method:"POST"})}async stopSync(t){await this.fetch(`/api/syncs/${t}/stop`,{method:"POST"})}async testSync(t){await this.fetch(`/api/syncs/${t}/test`,{method:"POST"})}async getTcpTunnels(){return(await this.fetch("/api/tcp-tunnels")).data}async createTcpTunnel(t){return(await this.fetch("/api/tcp-tunnels",{method:"POST",body:JSON.stringify(t)})).data}async updateTcpTunnel(t,e){await this.fetch(`/api/tcp-tunnels/${t}`,{method:"PUT",body:JSON.stringify(e)})}async deleteTcpTunnel(t){await this.fetch(`/api/tcp-tunnels/${t}`,{method:"DELETE"})}async restartTcpTunnel(t){await this.fetch(`/api/tcp-tunnels/${t}/restart`,{method:"POST"})}async startTcpTunnel(t){await this.fetch(`/api/tcp-tunnels/${t}/start`,{method:"POST"})}async stopTcpTunnel(t){await this.fetch(`/api/tcp-tunnels/${t}/stop`,{method:"POST"})}async testTcpTunnel(t){await this.fetch(`/api/tcp-tunnels/${t}/test`,{method:"POST"})}async copyTcpTunnel(t){await this.fetch(`/api/tcp-tunnels/${t}/copy`,{method:"POST"})}async getTerminals(){return(await this.fetch("/api/terminals")).data}async createTerminal(t){return(await this.fetch("/api/terminals",{method:"POST",body:JSON.stringify(t)})).data}async updateTerminal(t,e){await this.fetch(`/api/terminals/${t}`,{method:"PUT",body:JSON.stringify(e)})}async deleteTerminal(t){await this.fetch(`/api/terminals/${t}`,{method:"DELETE"})}async startTerminal(t){await this.fetch(`/api/terminals/${t}/start`,{method:"POST"})}async stopTerminal(t){await this.fetch(`/api/terminals/${t}/stop`,{method:"POST"})}async restartTerminal(t){await this.fetch(`/api/terminals/${t}/restart`,{method:"POST"})}async upgradeGotty(){await this.fetch("/api/terminals/upgrade",{method:"POST"})}async getVncSessions(){return(await this.fetch("/api/vnc-sessions")).data}async createVncSession(t){return(await this.fetch("/api/vnc-sessions",{method:"POST",body:JSON.stringify(t)})).data}async updateVncSession(t,e){await this.fetch(`/api/vnc-sessions/${t}`,{method:"PUT",body:JSON.stringify(e)})}async deleteVncSession(t){await this.fetch(`/api/vnc-sessions/${t}`,{method:"DELETE"})}async startVncSession(t){await this.fetch(`/api/vnc-sessions/${t}/start`,{method:"POST"})}async stopVncSession(t){await this.fetch(`/api/vnc-sessions/${t}/stop`,{method:"POST"})}async restartVncSession(t){await this.fetch(`/api/vnc-sessions/${t}/restart`,{method:"POST"})}async getApps(){return(await this.fetch("/api/apps")).data}async getAppTemplates(){return(await this.fetch("/api/apps/templates")).data}async createApp(t){return(await this.fetch("/api/apps",{method:"POST",body:JSON.stringify(t)})).data}async updateApp(t,e){await this.fetch(`/api/apps/${t}`,{method:"PUT",body:JSON.stringify(e)})}async startApp(t){await this.fetch(`/api/apps/${t}/start`,{method:"POST"})}async stopApp(t){await this.fetch(`/api/apps/${t}/stop`,{method:"POST"})}async restartApp(t){await this.fetch(`/api/apps/${t}/restart`,{method:"POST"})}async deleteApp(t){await this.fetch(`/api/apps/${t}`,{method:"DELETE"})}async checkUpdate(){return(await this.fetch("/api/update")).data}async performUpdate(){await this.fetch("/api/update",{method:"POST"})}async reloadSubscription(){await this.fetch("/api/clash/reload",{method:"POST"})}async getLogs(){return(await this.fetch("/api/logs")).data}};function a(){let t=localStorage.getItem("miao_token");if(!t)throw Error("No authentication token found. Please login first.");let e="".replace("http","ws");return`${e}/api/clash/ws/traffic?token=${t}`}function s(){let t=localStorage.getItem("miao_token");if(!t)throw Error("No authentication token found. Please login first.");let e="".replace("http","ws");return`${e}/api/clash/ws/logs?token=${t}`}t.s(["api",0,e,"getLogsWsUrl",()=>s,"getTrafficWsUrl",()=>a])},87208,(t,e,a)=>{e.exports=t.r(30204)},70307,t=>{"use strict";var e=t.i(87519),a=t.i(86646),s=t.i(87208);t.i(16787);var i=t.i(2163),n=t.i(50736),c=t.i(82291),r=t.i(9165);let o=(0,t.i(98631).default)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var h=t.i(56625),d=t.i(86094);function p(){let t=(0,s.useRouter)(),[p,l]=(0,a.useState)(""),[y,u]=(0,a.useState)(""),[f,m]=(0,a.useState)(!1),[w,S]=(0,a.useState)(""),g=async e=>{if(e.preventDefault(),S(""),p!==y)return void S("两次输入的密码不一致");if(p.length<4)return void S("密码长度至少为4位");m(!0);try{await r.api.setup(p),await r.api.login(p),t.push("/dashboard")}catch(t){S(t instanceof Error?t.message:"初始化失败")}finally{m(!1)}};return(0,e.jsxs)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:[(0,e.jsx)(c.ClayBlobs,{}),(0,e.jsx)("div",{className:"relative w-full max-w-md",children:(0,e.jsxs)("div",{className:"bg-white rounded-xl shadow-[0_20px_50px_-12px_rgba(79,70,229,0.25)] border border-slate-100 p-8",children:[(0,e.jsxs)("div",{className:"text-center mb-8",children:[(0,e.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-xl bg-gradient-to-r from-indigo-600 to-violet-600 shadow-[0_4px_14px_0_rgba(79,70,229,0.3)] mb-4",children:(0,e.jsx)(o,{className:"w-8 h-8 text-white"})}),(0,e.jsx)("h1",{className:"text-3xl font-extrabold text-slate-900",children:"初始化设置"}),(0,e.jsx)("p",{className:"mt-2 text-slate-500",children:"创建您的管理密码"})]}),(0,e.jsxs)("form",{onSubmit:g,className:"space-y-6",children:[(0,e.jsx)("div",{children:(0,e.jsx)(n.Input,{type:"password",placeholder:"设置登录密码",value:p,onChange:t=>l(t.target.value),disabled:f,autoFocus:!0})}),(0,e.jsx)("div",{children:(0,e.jsx)(n.Input,{type:"password",placeholder:"确认密码",value:y,onChange:t=>u(t.target.value),disabled:f})}),w&&(0,e.jsxs)("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-red-50 border border-red-100 text-red-700 text-sm",children:[(0,e.jsx)(h.AlertCircle,{className:"w-4 h-4 flex-shrink-0"}),(0,e.jsx)("span",{children:w})]}),(0,e.jsxs)("div",{className:"flex items-start gap-3 p-4 rounded-lg bg-indigo-50 border border-indigo-100",children:[(0,e.jsx)(d.Info,{className:"w-5 h-5 text-indigo-600 flex-shrink-0 mt-0.5"}),(0,e.jsxs)("div",{className:"text-sm text-slate-600",children:[(0,e.jsxs)("p",{children:["初始化完成后，将订阅文件放入 ",(0,e.jsx)("code",{className:"px-1.5 py-0.5 rounded bg-white text-slate-900 border border-slate-200",children:"sub/"}),' 目录，再在面板中点击"重载"。']}),(0,e.jsxs)("p",{className:"mt-2",children:["也可使用 ",(0,e.jsx)("code",{className:"px-1.5 py-0.5 rounded bg-white text-slate-900 border border-slate-200",children:"--sub <GIT_URL>"})," 启动参数。"]})]})]}),(0,e.jsx)(i.Button,{type:"submit",className:"w-full",loading:f,disabled:!p||!y||f,children:"完成初始化"})]})]})})]})}t.s(["default",()=>p],70307)}]);