(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,14346,65309,e=>{"use strict";var s=e.i(98631);let a=(0,s.default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);e.s(["Play",()=>a],14346);let t=(0,s.default)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);e.s(["Square",()=>t],65309)},14136,e=>{"use strict";let s=(0,e.i(98631).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>s],14136)},43293,611,e=>{"use strict";var s=e.i(98631);let a=(0,s.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],43293);let t=(0,s.default)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);e.s(["Pencil",()=>t],611)},66974,e=>{"use strict";let s=(0,e.i(98631).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>s],66974)},15682,e=>{"use strict";let s=(0,e.i(98631).default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);e.s(["ExternalLink",()=>s],15682)},4948,e=>{"use strict";var s=e.i(87519),a=e.i(86646);e.i(16787);var t=e.i(26791),l=e.i(2163),r=e.i(63917),n=e.i(67559),i=e.i(50736),c=e.i(1257),d=e.i(9165),o=e.i(75157),p=e.i(1836),h=e.i(43293),m=e.i(15682),u=e.i(14136),x=e.i(66974),g=e.i(14346),y=e.i(65309),v=e.i(611);let j={name:"",enabled:!0,addr:"0.0.0.0",port:"7900",display:":10",resolution:"1920x1080",depth:"24",frame_rate:"24",password:"",view_only:!1,restart_on_save:!0,clear_password:!1};function f(){let{setLoading:e,loading:f,addToast:w}=(0,c.useStore)(),[N,b]=(0,a.useState)([]),[k,C]=(0,a.useState)(!1),[_,S]=(0,a.useState)(!1),[M,V]=(0,a.useState)(null),[P,B]=(0,a.useState)(j);(0,a.useEffect)(()=>{I()},[]);let I=async()=>{try{let e=await d.api.getVncSessions();b(e),C(!0)}catch(e){console.error("Failed to load VNC sessions:",e),C(!0)}},z=e=>{let s=(e.addr||"").trim(),a=s&&"0.0.0.0"!==s?s:window.location.hostname,t=Number(e.port)||0;return t?`http://${a}:${t}`:""},E=e=>{e?(V(e.id),B({name:e.name||"",enabled:e.enabled??!0,addr:e.addr||"0.0.0.0",port:e.port?.toString()||"7900",display:e.display||":10",resolution:e.resolution||"1920x1080",depth:e.depth?.toString()||"24",frame_rate:e.frame_rate?.toString()||"24",password:"",view_only:!!e.view_only,restart_on_save:!0,clear_password:!1})):(V(null),B(j)),S(!0)},q=async()=>{e(!0,"save");try{let e={name:P.name.trim()||null,enabled:P.enabled,addr:P.addr.trim(),port:Number(P.port)||0,display:P.display.trim(),resolution:P.resolution.trim(),depth:Number(P.depth)||0,frame_rate:Number(P.frame_rate)||0,view_only:P.view_only,restart:!!M&&P.restart_on_save&&P.enabled},s=P.password.trim();M?(P.clear_password?e.password="":s&&(e.password=s),await d.api.updateVncSession(M,e),w({type:"success",message:"VNC 会话已更新"})):(s&&(e.password=s),await d.api.createVncSession(e),w({type:"success",message:"VNC 会话已添加"})),S(!1),V(null),B(j),I()}catch(e){w({type:"error",message:e instanceof Error?e.message:"操作失败"})}finally{e(!1)}},L=async s=>{let a=s.enabled??s.status.running;e(!0,a?"stop":"start");try{a?(await d.api.stopVncSession(s.id),w({type:"success",message:"VNC 会话已停止"})):(await d.api.startVncSession(s.id),w({type:"success",message:"VNC 会话已启动"})),I()}catch(e){w({type:"error",message:e instanceof Error?e.message:"操作失败"})}finally{e(!1)}},T=async s=>{e(!0,"restart");try{await d.api.restartVncSession(s.id),w({type:"success",message:"VNC 会话已重启"}),I()}catch(e){w({type:"error",message:e instanceof Error?e.message:"重启失败"})}finally{e(!1)}},A=async s=>{if(confirm("确定要删除此桌面吗？")){e(!0,"delete");try{await d.api.deleteVncSession(s),w({type:"success",message:"桌面已删除"}),I()}catch(e){w({type:"error",message:e instanceof Error?e.message:"删除失败"})}finally{e(!1)}}};return k?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-black",children:"远程桌面"}),(0,s.jsx)("p",{className:"text-slate-500 mt-1",children:"管理 VNC 桌面会话"})]}),(0,s.jsxs)(l.Button,{onClick:()=>E(),children:[(0,s.jsx)(h.Plus,{className:"w-4 h-4"}),"创建桌面"]})]}),(0,s.jsxs)("div",{className:"grid gap-4",children:[N.map(e=>{let a=e.enabled??e.status.running;return(0,s.jsx)(t.Card,{className:"p-4",hoverEffect:!0,children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-violet-600/10 flex items-center justify-center",children:(0,s.jsx)(p.Monitor,{className:"w-5 h-5 text-violet-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-bold",children:e.name||e.id}),(0,s.jsx)(r.Badge,{variant:e.status.running?"success":"default",children:e.status.running?"running":"stopped"})]}),(0,s.jsxs)("p",{className:"text-sm text-slate-500",children:["地址: ",e.addr,":",e.port]}),(0,s.jsxs)("p",{className:"text-sm text-slate-500",children:["DISPLAY: ",e.display," · 分辨率: ",e.resolution," · 深度: ",e.depth," · FPS: ",e.frame_rate]}),(0,s.jsxs)("p",{className:"text-sm text-slate-500",children:["只读: ",e.view_only?"是":"否"," · 密码: ",e.password||"-"]}),e.status.running&&(0,s.jsxs)("p",{className:"text-sm text-slate-500",children:["PID: ",e.status.pid||"-"," · 运行: ",(0,o.formatUptime)(e.status.uptime_secs)]})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(l.Button,{variant:"primary",size:"sm",onClick:()=>{let s=z(e);s&&window.open(s,"_blank")},disabled:!z(e),children:[(0,s.jsx)(m.ExternalLink,{className:"w-4 h-4"}),"打开桌面"]}),(0,s.jsxs)(l.Button,{variant:"secondary",size:"sm",onClick:()=>T(e),children:[(0,s.jsx)(x.RefreshCw,{className:"w-4 h-4"}),"重启"]}),(0,s.jsx)(l.Button,{variant:"secondary",size:"sm",onClick:()=>L(e),children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y.Square,{className:"w-4 h-4"}),"停止"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.Play,{className:"w-4 h-4"}),"启动"]})}),(0,s.jsxs)(l.Button,{variant:"ghost",size:"sm",onClick:()=>E(e),children:[(0,s.jsx)(v.Pencil,{className:"w-4 h-4"}),"编辑"]}),(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>A(e.id),children:(0,s.jsx)(u.Trash2,{className:"w-4 h-4 text-red-500"})})]})]})},e.id)}),0===N.length&&(0,s.jsx)(t.Card,{className:"p-12 text-center",children:(0,s.jsx)("p",{className:"text-slate-500",children:"暂无桌面会话"})})]}),(0,s.jsx)(n.Modal,{isOpen:_,onClose:()=>S(!1),title:M?"编辑 VNC 会话":"创建桌面",size:"lg",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(i.Input,{label:"名称",placeholder:"例如: chromium-vnc",value:P.name,onChange:e=>B({...P,name:e.target.value})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600 pt-7",children:[(0,s.jsx)("input",{type:"checkbox",checked:P.enabled,onChange:e=>B({...P,enabled:e.target.checked})}),P.enabled?"已启用":"未启用"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsx)(i.Input,{label:"绑定地址",placeholder:"0.0.0.0",value:P.addr,onChange:e=>B({...P,addr:e.target.value})}),(0,s.jsx)(i.Input,{label:"端口",type:"number",value:P.port,onChange:e=>B({...P,port:e.target.value})}),(0,s.jsx)(i.Input,{label:"DISPLAY",placeholder:":10",value:P.display,onChange:e=>B({...P,display:e.target.value})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsx)(i.Input,{label:"分辨率",placeholder:"1920x1080",value:P.resolution,onChange:e=>B({...P,resolution:e.target.value})}),(0,s.jsx)(i.Input,{label:"深度",type:"number",value:P.depth,onChange:e=>B({...P,depth:e.target.value})}),(0,s.jsx)(i.Input,{label:"FPS",type:"number",value:P.frame_rate,onChange:e=>B({...P,frame_rate:e.target.value})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(i.Input,{label:"密码",placeholder:M?"留空保持不变":"留空使用默认密码",value:P.password,onChange:e=>B({...P,password:e.target.value})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600 pt-7",children:[(0,s.jsx)("input",{type:"checkbox",checked:P.view_only,onChange:e=>B({...P,view_only:e.target.checked})}),P.view_only?"只读":"可操作"]})]}),M&&(0,s.jsxs)("div",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:P.restart_on_save,onChange:e=>B({...P,restart_on_save:e.target.checked})}),"保存后重启"]}),(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:P.clear_password,onChange:e=>B({...P,clear_password:e.target.checked})}),"清除密码"]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,s.jsx)(l.Button,{variant:"secondary",onClick:()=>S(!1),children:"取消"}),(0,s.jsx)(l.Button,{onClick:q,loading:f,children:"保存"})]})]})})]}):(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"w-12 h-12 border-4 border-indigo-600/30 border-t-indigo-600 rounded-full animate-spin mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-slate-500",children:"加载中..."})]})})}e.s(["default",()=>f])}]);